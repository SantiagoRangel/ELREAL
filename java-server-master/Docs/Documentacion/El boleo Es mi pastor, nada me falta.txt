SELECT *
FROM (SELECT TRUNC((SYSDATE - TO_DATE(FECHAINIC, 'YYYY-MM-DD"T"HH24:MI:SS"Z"')),0) AS ANTIGUEDAD
FROM CONTRATO
ORDER BY ANTIGUEDAD DESC)
WHERE ROWNUM = 1;

Antiguedad de Alohandes

SELECT TRUNC (SYSDATE - ROWNUM) AS DIA
FROM DUAL CONNECT BY ROWNUM <= (SELECT *
FROM (SELECT TRUNC((SYSDATE - TO_DATE(FECHAINIC, 'YYYY-MM-DD"T"HH24:MI:SS"Z"')),0) AS ANTIGUEDAD
FROM CONTRATO
ORDER BY ANTIGUEDAD DESC)
WHERE ROWNUM = 1);

Todos los dias de existencia de Alohandes

SELECT TRUNC (((SYSDATE-DIA)/7),0) AS SEGMENTO
FROM (SELECT TRUNC (SYSDATE - ROWNUM) AS DIA
FROM DUAL CONNECT BY ROWNUM <= (SELECT *
FROM (SELECT TRUNC((SYSDATE - TO_DATE(FECHAINIC, 'YYYY-MM-DD"T"HH24:MI:SS"Z"')),0) AS ANTIGUEDAD
FROM CONTRATO
ORDER BY ANTIGUEDAD DESC)
WHERE ROWNUM = 1));

Los dias de existencia de Alohandes, partidos en segmentos


SELECT IDCONTRATO, COSTO, FECHAINIC, FECHAFINAL,
(TO_DATE(FECHAFINAL, 'YYYY-MM-DD"T"HH24:MI:SS"Z"')-TO_DATE(FECHAINIC, 'YYYY-MM-DD"T"HH24:MI:SS"Z"')) AS DURACION, 
GREATEST ((SYSDATE-TO_DATE(FECHAFINAL, 'YYYY-MM-DD"T"HH24:MI:SS"Z"')), 0) AS ANTIGUEDAD
FROM CONTRATO;

Duracion y antiguedad de cada contrato

SELECT IDCONTRATO, COSTO, FECHAINIC, FECHAFINAL,
TRUNC((ANTIGUEDAD/7),0) AS SEGI, TRUNC (((ANTIGUEDAD+DURACION)/7),0) AS SEGII
FROM (SELECT IDCONTRATO, COSTO, FECHAINIC, FECHAFINAL,
(TO_DATE(FECHAFINAL, 'YYYY-MM-DD"T"HH24:MI:SS"Z"')-TO_DATE(FECHAINIC, 'YYYY-MM-DD"T"HH24:MI:SS"Z"')) AS DURACION, 
GREATEST ((SYSDATE-TO_DATE(FECHAFINAL, 'YYYY-MM-DD"T"HH24:MI:SS"Z"')), 0) AS ANTIGUEDAD
FROM CONTRATO);

El intervalo de segmentos de validez de cada contrato

SELECT * 
FROM (SELECT TRUNC (((SYSDATE-DIA)/7),0) AS SEGMENTO
FROM (SELECT TRUNC (SYSDATE - ROWNUM) AS DIA
FROM DUAL CONNECT BY ROWNUM <= (SELECT *
FROM (SELECT TRUNC((SYSDATE - TO_DATE(FECHAINIC, 'YYYY-MM-DD"T"HH24:MI:SS"Z"')),0) AS ANTIGUEDAD
FROM CONTRATO
ORDER BY ANTIGUEDAD DESC)
WHERE ROWNUM = 1))) INNER JOIN
(SELECT IDCONTRATO, COSTO, FECHAINIC, FECHAFINAL,
TRUNC((ANTIGUEDAD/7),0) AS SEGI, TRUNC (((ANTIGUEDAD+DURACION)/7),0) AS SEGII
FROM (SELECT IDCONTRATO, COSTO, FECHAINIC, FECHAFINAL,
(TO_DATE(FECHAFINAL, 'YYYY-MM-DD"T"HH24:MI:SS"Z"')-TO_DATE(FECHAINIC, 'YYYY-MM-DD"T"HH24:MI:SS"Z"')) AS DURACION, 
GREATEST ((SYSDATE-TO_DATE(FECHAFINAL, 'YYYY-MM-DD"T"HH24:MI:SS"Z"')), 0) AS ANTIGUEDAD
FROM CONTRATO)) ON 
SEGMENTO >= SEGI AND SEGMENTO <= SEGII;

Cada contrato en el segmento que debe estar 