SELECT *
FROM CLIENTE
WHERE IDCLIENTE IN ( SELECT IDENTIFICACIONI
FROM (SELECT IDCLIENTE AS IDENTIFICACIONI, COUNT (IDCONTRATO) AS CUENTA
FROM CONTRATO
WHERE IDHABITACION = 10001
GROUP BY IDCLIENTE)
WHERE CUENTA >= 3) OR IDCLIENTE IN (SELECT IDENTIFICACIONII
FROM( SELECT IDCLIENTE AS IDENTIFICACIONII, SUM (NOCHES) AS TIEMPO
FROM CONTRATO
WHERE IDHABITACION = 10001
GROUP BY IDCLIENTE)
WHERE TIEMPO >=15);