SELECT *
FROM OFERTA
WHERE IDOFERTA NOT IN (SELECT IDOFERTA
FROM (SELECT NVL(IDVIVIENDA, 0) AS IDVII, NVL(IDHABITACION, 0) AS IDHII, NVL(IDAPARTAMENTO, 0) AS IDAII, IDOFERTA
FROM OFERTA 
WHERE TO_DATE(FECHAFINAL, 'YYYY-MM-DD"T"HH24:MI:SS"Z"')>= SYSDATE AND
TO_DATE(FECHAINICIAL, 'YYYY-MM-DD"T"HH24:MI:SS"Z"')< ADD_MONTHS(SYSDATE, -1)) INNER JOIN 
(SELECT NVL(IDVIVIENDA, 0) AS IDVI, NVL(IDHABITACION, 0) AS IDHI, NVL(IDAPARTAMENTO, 0) AS IDAI
FROM CONTRATO 
WHERE TO_DATE(FECHAFINAL, 'YYYY-MM-DD"T"HH24:MI:SS"Z"')>= ADD_MONTHS(SYSDATE, -1)) ON 
IDVII = IDVI AND IDHII = IDHI AND IDAII = IDAI) AND IDOFERTA IN (SELECT IDOFERTA
FROM OFERTA 
WHERE TO_DATE(FECHAFINAL, 'YYYY-MM-DD"T"HH24:MI:SS"Z"')>= SYSDATE AND
TO_DATE(FECHAINICIAL, 'YYYY-MM-DD"T"HH24:MI:SS"Z"')< ADD_MONTHS(SYSDATE, -1));