SELECT HAB, APT, VIV
FROM (SELECT HAB, APT, VIV, ((TO_DATE('2008-11-11',  'YYYY-MM-DD HH24:MI:SS'))-(TO_DATE(FF,  'YYYY-MM-DD HH24:MI:SS')))AS FFF, 
((TO_DATE(FI,  'YYYY-MM-DD HH24:MI:SS'))-(TO_DATE('2006-11-10',  'YYYY-MM-DD HH24:MI:SS'))) AS FIF
FROM (SELECT HAB, APT, VIV, FF, FI
FROM (SELECT IDHAB
FROM (SELECT IDSH, IDHAB
FROM (SELECT IDSH, IDHAB
FROM (SELECT IDSERVICIOHABITACION AS IDSH, IDHABITACION AS IDHAB
FROM HABITACIONOFRECE) INNER JOIN
(SELECT IDHABITACION AS IDSHI FROM HABITACION)
ON IDSHI = IDHAB) INNER JOIN
(SELECT IDSERVICIOHABITACION AS LOL
FROM SERVICIOHABITACION) ON LOL = IDSH)
WHERE IDSH = 10001) INNER JOIN
(SELECT FF, FI, HAB, APT, VIV
FROM (SELECT FECHAFINAL AS FF, FECHAINICIAL AS FI, 
IDHABITACION AS HAB, IDAPARTAMENTO AS APT, IDVIVIENDA AS VIV, DISPONIBLE
FROM OFERTA
WHERE DISPONIBLE = 1)) ON HAB = IDHAB))
WHERE FFF >= 0 AND FIF >= 0;