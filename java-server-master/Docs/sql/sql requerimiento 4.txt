SELECT HABITACIONES, APARTAMENTOS, VIVIENDAS
FROM (SELECT IDH AS HABITACIONES, IDA AS APARTAMENTOS, IDV AS VIVIENDAS, IDSERVICIOHABITACION AS  IDSH
FROM (SELECT *  
FROM (SELECT IDHABITACION AS IDH, IDAPARTAMENTO AS IDA, IDAPARTAMENTO AS IDV, IDOFERTA
FROM OFERTA
WHERE (TO_DATE(FECHAINICIAL,  'YYYY-MM-DD'))-(TO_DATE('2000-01-01',  'YYYY-MM-DD'))>=0
AND (TO_DATE(FECHAFINAL,  'YYYY-MM-DD'))-(TO_DATE('2019-01-01',  'YYYY-MM-DD'))<=0
AND NOT (IDHABITACION IS NULL AND IDAPARTAMENTO IS NULL)) INNER JOIN HABITACIONOFRECE 
ON (IDH = IDHABITACION OR IDA = IDHABITACION OR IDV = IDHABITACION)))
WHERE IDSH = 30001 OR IDSH = 30002 OR IDSH = 30003;