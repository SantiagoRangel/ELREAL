SELECT *
FROM(SELECT IDA, COUNT(IDA) AS CUENTA
FROM (OPERADOR INNER JOIN 
(SELECT NVL (IDHABITACION,0) + NVL (IDAPARTAMENTO, 0) + NVL (IDVIVIENDA,0) AS IDA, IDCONTRATO, COSTO, FECHAFINAL, FECHAINIC, NOCHES, DESCRIPCION, IDOPERADOR, IDCLIENTE
FROM CONTRATO) ON IDA = OPERADOR.IDOPERADOR)
INNER JOIN (SELECT NVL (IDHABITACION,0) + NVL (IDAPARTAMENTO, 0) + NVL (IDVIVIENDA,0) AS IDB, IDOFERTA, FECHAINICIAL, FECHAFINAL, IDOPERADOR
FROM OFERTA) ON IDB = OPERADOR.IDOPERADOR AND IDA = IDB 
GROUP BY IDA
ORDER BY CUENTA) 
WHERE ROWNUM <= 20;